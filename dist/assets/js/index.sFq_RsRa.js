(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=o(a);fetch(a.href,i)}})();async function S(e,t){console.log(`[include] Trying to inject ${t} into ${e}`);const o=document.querySelector(e);if(!o){console.error(`[include] Target element not found: ${e}`);return}console.log("[include] Found target element");try{console.log(`[include] Fetching from ${t}`);const n=await fetch(t,{cache:"no-cache"});if(!n.ok)throw new Error(n.status+" "+n.statusText);const a=await n.text();console.log(`[include] Loaded content (${a.length} bytes)`),o.innerHTML=a,console.log(`[include] Successfully injected content into ${e}`)}catch(n){console.error("[include] failed:",t,n)}}const A=Object.freeze(Object.defineProperty({__proto__:null,inject:S},Symbol.toStringTag,{value:"Module"}));S("#headbarContainer","/components/headbar");S("#pageFooter","/components/footer");const z="modulepreload",N=function(e){return"/"+e},P={},E=function(t,o,n){let a=Promise.resolve();if(o&&o.length>0){let c=function(l){return Promise.all(l.map(y=>Promise.resolve(y).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),x=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));a=c(o.map(l=>{if(l=N(l),l in P)return;P[l]=!0;const y=l.endsWith(".css"),g=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${g}`))return;const d=document.createElement("link");if(d.rel=y?"stylesheet":z,y||(d.as="script"),d.crossOrigin="",d.href=l,x&&d.setAttribute("nonce",x),document.head.appendChild(d),y)return new Promise((W,H)=>{d.addEventListener("load",W),d.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(c){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=c,window.dispatchEvent(s),!s.defaultPrevented)throw c}return a.then(c=>{for(const s of c||[])s.status==="rejected"&&i(s.reason);return t().catch(i)})};document.body.style.overflow="auto";const b=setTimeout(()=>{console.warn("Waitlist safety timeout triggered - ensuring page is usable"),document.body.style.overflow="auto",document.querySelectorAll("dialog").forEach(t=>{try{t.classList.add("opacity-0","pointer-events-none","hidden"),t.hasAttribute("open")&&(typeof t.close=="function"&&t.close(),t.removeAttribute("open"))}catch(o){console.error("Error cleaning up dialog:",o)}})},8e3);function K(){E(async()=>{const{inject:e}=await Promise.resolve().then(()=>A);return{inject:e}},void 0).then(({inject:e})=>{e("body","/components/waitlist-modal-v3").then(()=>{E(async()=>{const{initHomepagePopup:t}=await Promise.resolve().then(()=>Q);return{initHomepagePopup:t}},void 0).then(({initHomepagePopup:t})=>{clearTimeout(b),window.addEventListener("load",()=>{setTimeout(()=>{try{t(3e3)}catch(o){console.error("Error initializing popup:",o),document.body.style.overflow="auto"}},100)})}).catch(t=>{console.error("Failed to load waitlist modal script:",t),clearTimeout(b),document.body.style.overflow="auto"})}).catch(t=>{console.error("Failed to inject waitlist modal:",t),clearTimeout(b),document.body.style.overflow="auto"})}).catch(e=>{console.error("Waitlist modal initialization failed:",e),clearTimeout(b),document.body.style.overflow="auto"})}K();console.log("app.js loaded");document.addEventListener("DOMContentLoaded",function(){console.log("Application initialized"),R(),U(),document.querySelector("#metricsTable")&&(C(),setInterval(C,1e4))});function R(){const e=document.querySelector("#videoModal"),t=document.querySelector("#openVideoModal"),o=document.querySelector("#closeVideoModal");e&&t&&o&&(t.addEventListener("click",()=>{e.classList.remove("hidden"),document.body.classList.add("overflow-hidden")}),o.addEventListener("click",()=>{e.classList.add("hidden"),document.body.classList.remove("overflow-hidden")}));const n=document.querySelector("#demoModal"),a=document.querySelector("#openDemoModal"),i=document.querySelector("#closeDemoModal");n&&a&&i&&(a.addEventListener("click",()=>{n.classList.remove("hidden"),document.body.classList.add("overflow-hidden")}),i.addEventListener("click",()=>{n.classList.add("hidden"),document.body.classList.remove("overflow-hidden")}))}function U(){const e=document.querySelectorAll(".fade-in");if(e.length>0){const t=new IntersectionObserver(o=>{o.forEach(n=>{n.isIntersecting&&(n.target.classList.add("opacity-100"),n.target.classList.remove("opacity-0","translate-y-8"),t.unobserve(n.target))})},{threshold:.1});e.forEach(o=>{o.classList.add("opacity-0","translate-y-8","transition-all","duration-700"),t.observe(o)})}}function C(){const e={latency:Math.floor(Math.random()*10)+70,txLead:Math.floor(Math.random()*50)+100,volume:(Math.random()*2+27).toFixed(1),activeTraders:Math.floor(Math.random()*100)+2200};document.querySelectorAll('[data-metric="latency"]').forEach(t=>{t.textContent=`${e.latency} ms`}),document.querySelectorAll('[data-metric="txLead"]').forEach(t=>{t.textContent=`+${e.txLead} ms`}),document.querySelectorAll('[data-metric="volume"]').forEach(t=>{t.textContent=`${e.volume} SOL`}),document.querySelectorAll('[data-metric="activeTraders"]').forEach(t=>{t.textContent=e.activeTraders.toLocaleString()}),document.querySelectorAll('[data-metric="lastUpdated"]').forEach(t=>{t.textContent=new Date().toLocaleTimeString()})}const h="rr_wait_home_v3";let r=null,L=null,m=[],f=null,p=!1;document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("click",e=>{e.target.closest("[data-waitlist]")&&(e.preventDefault(),j())})});async function O(e,t="hero-form"){if(!e||!F(e))throw new Error("Please enter a valid email address");try{const o=await fetch("/api/waitlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,source:t})});if(!o.ok){const n=await o.json().catch(()=>({message:"Something went wrong. Please try again later."}));throw new Error(n.message||"Something went wrong. Please try again later.")}return localStorage.setItem(h,"1"),{success:!0}}catch(o){throw console.error("Error joining waitlist:",o),o}}function j(){try{if(localStorage.getItem(h)){console.log("User already on waitlist, not showing modal again");return}I(),r&&B()}catch(e){console.error("Error opening waitlist modal:",e)}}function I(){if(r===null)try{if(document.body.style.overflow="auto",f&&clearTimeout(f),f=setTimeout(()=>{console.warn("Waitlist modal safety timeout triggered - resetting page state"),u()},1e4),r=document.getElementById("waitlistModal"),!r){console.warn("Waitlist modal element not found, attempting to inject it"),V();return}p||(r.addEventListener("keydown",T),r.addEventListener("click",M),document.addEventListener("click",k),document.addEventListener("submit",_),p=!0)}catch(e){console.error("Error initializing modal:",e),u()}}async function V(){try{const{inject:e}=await E(async()=>{const{inject:t}=await Promise.resolve().then(()=>A);return{inject:t}},void 0);if(await e("body","/components/waitlist-modal-v3"),r=document.getElementById("waitlistModal"),!r){console.error("Failed to inject waitlist modal");return}p||(r.addEventListener("keydown",T),r.addEventListener("click",M),document.addEventListener("click",k),document.addEventListener("submit",_),p=!0)}catch(e){console.error("Error injecting modal:",e)}}function J(e=3e3){try{if(!location.pathname.endsWith("index.html")&&location.pathname!=="/"&&location.pathname!==""||localStorage.getItem(h)||localStorage.getItem("rr_wait_home_v3"))return;I(),r&&setTimeout(()=>B(),e)}catch(t){console.error("Error initializing waitlist modal:",t),u()}}function B(){try{if(!r){clearTimeout(f);return}L=document.activeElement;try{if(typeof r.showModal=="function"){r.showModal();const e=document.createElement("style");e.id="modal-backdrop-fix",e.textContent=`
          dialog::backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            pointer-events: none;
          }
        `,document.head.appendChild(e)}else r.style.display="block",r.setAttribute("open","")}catch(e){console.warn("Dialog API failed, using fallback:",e),r.style.display="block",r.setAttribute("open",""),document.body.style.overflow="auto"}requestAnimationFrame(()=>{r.classList.remove("translate-y-full","opacity-0"),r.classList.remove("pointer-events-none"),r.classList.add("pointer-events-auto")}),Y(),window.matchMedia("(prefers-reduced-motion: reduce)").matches&&(r.style.transition="none",r.classList.remove("translate-y-full","opacity-0"),r.classList.remove("pointer-events-none"),r.classList.add("pointer-events-auto")),clearTimeout(f)}catch(e){console.error("Error opening modal:",e),u()}}function v(){try{if(!r)return;localStorage.setItem(h,"1"),r.classList.add("translate-y-full","opacity-0"),r.classList.remove("pointer-events-auto"),r.classList.add("pointer-events-none"),clearTimeout(f),setTimeout(()=>{try{const e=document.getElementById("modal-backdrop-fix");e&&e.remove(),typeof r.close=="function"?r.close():(r.style.display="none",r.removeAttribute("open"))}catch(e){console.warn("Dialog API failed during close, using fallback:",e),r.style.display="none",r.removeAttribute("open")}document.body.style.overflow="auto",L&&L.focus(),D()},300)}catch(e){console.error("Error closing modal:",e),u()}}function u(){clearTimeout(f),document.body.style.overflow="auto";const e=document.getElementById("modal-backdrop-fix");if(e&&e.remove(),r&&(r.style.display="none",r.classList.add("opacity-0","pointer-events-none"),r.classList.remove("pointer-events-auto"),r.hasAttribute("open")))try{typeof r.close=="function"&&r.close(),r.removeAttribute("open")}catch(t){console.error("Error force closing modal:",t)}D(),localStorage.setItem(h,"1")}function D(){p&&(r&&(r.removeEventListener("keydown",T),r.removeEventListener("click",M),r.removeEventListener("keydown",$)),document.removeEventListener("click",k),document.removeEventListener("submit",_),p=!1)}function T(e){try{e.key==="Escape"&&(v(),e.preventDefault())}catch(t){console.error("Error handling escape key:",t),u()}}function k(e){try{e.target.closest("[data-close]")&&(v(),e.preventDefault())}catch(t){console.error("Error handling close button click:",t),u()}}function M(e){try{e.target===r&&v()}catch(t){console.error("Error handling backdrop click:",t),u()}}function F(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}function w(e,t){let o=e.querySelector(".form-error-message");o||(o=document.createElement("div"),o.className="form-error-message text-red-500 text-sm mt-2",e.appendChild(o)),o.textContent=t;const n=e.querySelector('input[type="email"]');n&&(n.classList.add("border-red-500"),n.focus())}function Z(e){const t=e.querySelector(".form-error-message");t&&t.remove();const o=e.querySelector('input[type="email"]');o&&o.classList.remove("border-red-500")}async function _(e){try{if(!e.target.matches("[data-waitlist-form]"))return;e.preventDefault();const t=e.target,o=t.email.value.trim();if(Z(t),!o){w(t,"Please enter your email address");return}if(!F(o)){w(t,"Please enter a valid email address");return}const n=t.querySelector('button[type="submit"]');n&&(n.disabled=!0,n.innerHTML="Submitting...");try{const a=await fetch("/api/waitlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,source:"homepage-modal-v3"})});if(a.ok)localStorage.setItem(h,"1"),G();else{const i=await a.json().catch(()=>({message:"Something went wrong. Please try again later."}));w(t,i.message||"Something went wrong. Please try again later."),n&&(n.disabled=!1,n.innerHTML="Join Waitlist")}}catch(a){console.error("Error submitting to waitlist:",a),w(t,"Network error. Please try again later."),n&&(n.disabled=!1,n.innerHTML="Join Waitlist")}}catch(t){console.error("Error handling form submission:",t),v()}}function G(){try{const e=r.querySelector('[data-step="1"]'),t=r.querySelector('[data-step="2"]');if(!e||!t)return;e.style.opacity="0",setTimeout(()=>{e.classList.add("hidden"),t.classList.remove("hidden"),t.offsetHeight,t.style.opacity="1"},300)}catch(e){console.error("Error showing success step:",e),v()}}function Y(){try{m=r.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),m.length>0&&(m[0].focus(),r.addEventListener("keydown",$))}catch(e){console.error("Error setting up focus trap:",e)}}function $(e){try{if(e.key!=="Tab"||m.length===0)return;const t=m[0],o=m[m.length-1];e.shiftKey&&document.activeElement===t?(o.focus(),e.preventDefault()):!e.shiftKey&&document.activeElement===o&&(t.focus(),e.preventDefault())}catch(t){console.error("Error trapping tab key:",t)}}const Q=Object.freeze(Object.defineProperty({__proto__:null,initHomepagePopup:J,joinWaitlist:O,openWaitlistModal:j},Symbol.toStringTag,{value:"Module"}));function q(e,t="success"){const o=document.createElement("div");o.className=`fixed bottom-4 right-4 z-50 py-2 px-4 rounded-lg shadow-lg transition-all duration-300 transform translate-y-0 opacity-0 ${t==="success"?"bg-neonGreen text-spaceBlack":"bg-red-500 text-white"}`,o.textContent=e,document.body.appendChild(o),setTimeout(()=>{o.classList.remove("translate-y-0","opacity-0"),o.classList.add("translate-y-0","opacity-100")},10),setTimeout(()=>{o.classList.remove("opacity-100"),o.classList.add("opacity-0","translate-y-2"),setTimeout(()=>o.remove(),300)},3e3)}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("heroWaitlist");e&&e.addEventListener("submit",async t=>{t.preventDefault();const o=e.email.value.trim(),n=e.querySelector('button[type="submit"]'),a=e.querySelector(".hero-form-error");if(e.email.classList.remove("border-red-500"),a&&(a.textContent=""),!o||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)){e.email.classList.add("border-red-500"),a&&(a.textContent="Enter valid email");return}const i=n.innerHTML;n.disabled=!0,n.innerHTML="Sending...";try{await O(o),n.innerHTML="Thanks!",e.email.disabled=!0,q("Check your inbox for the magic link 🚀"),localStorage.setItem("rr_wait_home_v3","1")}catch(c){n.disabled=!1,n.innerHTML=i,a&&(a.textContent=c.message||"Something went wrong, try again"),e.email.classList.add("border-red-500"),q("Something went wrong, try again","error")}})});
